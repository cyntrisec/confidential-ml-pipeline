{
  "benchmark": "GPT-2 124M Nitro Enclave Pipeline (VSock)",
  "date": "2026-02-09",
  "environment": {
    "instance_type": "m6i.2xlarge",
    "cpu": "Intel Xeon Platinum 8375C @ 2.90GHz (Ice Lake)",
    "vcpus_total": 8,
    "memory_total_gb": 32,
    "region": "us-east-1",
    "os": "Amazon Linux 2023 (kernel 6.1.161)",
    "enclave_kernel": "4.14.256-209.484.amzn2 (Nitro Enclave kernel)",
    "debug_mode": true
  },
  "model": {
    "name": "GPT-2 (openai-community/gpt2)",
    "parameters": "124M",
    "layers": 12,
    "hidden_dim": 768,
    "vocab_size": 50257,
    "format": "safetensors",
    "size_mb": 523,
    "kv_cache": true
  },
  "transport": {
    "protocol": "VSock (host <-> enclave, host relay for inter-stage)",
    "encryption": "ChaCha20-Poly1305 (AEAD per frame)",
    "handshake": "X25519 ECDH + HPKE key derivation",
    "attestation": "Mock (VSock transport verified)",
    "framing": "Binary tensor framing (confidential-ml-transport v0.2.0)"
  },
  "single_stage": {
    "commit": "c51cbc9",
    "stages": 1,
    "layers_per_stage": 12,
    "enclave_vcpus": 2,
    "enclave_memory_mb": 3072,
    "eif_size_mb": 614,
    "run_1": {
      "prompt": "The capital of France is",
      "prompt_tokens": 5,
      "max_tokens": 20,
      "output": "The capital of France is the capital of the French Republic, and the capital of the French Republic is the capital of the French",
      "ttft_ms": 91.7,
      "generation_avg_ms": 42.1,
      "generation_p50_ms": 42.0,
      "generation_p95_ms": 42.9,
      "tokens_per_second": 23.8
    },
    "run_2": {
      "prompt": "Machine learning is transforming",
      "prompt_tokens": 4,
      "max_tokens": 50,
      "ttft_ms": 84.4,
      "generation_avg_ms": 42.2,
      "generation_p50_ms": 42.1,
      "generation_p95_ms": 42.8,
      "tokens_per_second": 23.7
    }
  },
  "two_stage": {
    "commit": "f0656bf",
    "stages": 2,
    "layers_per_stage": 6,
    "enclave_vcpus_each": 2,
    "enclave_memory_mb_each": 3072,
    "eif_size_mb_each": 614,
    "relay_port": 6001,
    "run_1": {
      "prompt": "The capital of France is",
      "prompt_tokens": 5,
      "max_tokens": 20,
      "output": "The capital of France is the capital of the French Republic, and the capital of the French Republic is the capital of the French",
      "ttft_ms": 96.6,
      "generation_avg_ms": 45.5,
      "generation_p50_ms": 45.6,
      "generation_p95_ms": 46.2,
      "tokens_per_second": 22.0
    },
    "run_2": {
      "prompt": "Machine learning is transforming",
      "prompt_tokens": 4,
      "max_tokens": 50,
      "ttft_ms": 89.3,
      "generation_avg_ms": 45.4,
      "generation_p50_ms": 45.4,
      "generation_p95_ms": 46.8,
      "tokens_per_second": 22.0
    }
  },
  "three_stage": {
    "commit": "74bf9c0",
    "stages": 3,
    "layers_per_stage": 4,
    "enclave_vcpus_each": 2,
    "enclave_memory_mb_each": 3072,
    "eif_size_mb_each": 614,
    "relay_ports": [6001, 6002],
    "run_1": {
      "prompt": "The capital of France is",
      "prompt_tokens": 5,
      "max_tokens": 20,
      "output": "The capital of France is the capital of the French Republic, and the capital of the French Republic is the capital of the French",
      "ttft_ms": 99.6,
      "generation_avg_ms": 45.2,
      "generation_p50_ms": 45.2,
      "generation_p95_ms": 46.2,
      "tokens_per_second": 22.1
    },
    "run_2": {
      "prompt": "Machine learning is transforming",
      "prompt_tokens": 4,
      "max_tokens": 50,
      "ttft_ms": 88.8,
      "generation_avg_ms": 44.2,
      "generation_p50_ms": 44.2,
      "generation_p95_ms": 44.8,
      "tokens_per_second": 22.6
    }
  },
  "relay_overhead_2stage": {
    "ttft_delta_ms": 4.9,
    "generation_p50_delta_ms": 3.5,
    "generation_p95_delta_ms": 3.6,
    "throughput_delta_percent": -7.6,
    "note": "Overhead from two additional VSock hops (stage0->host->stage1) plus inter-stage SecureChannel handshake"
  },
  "relay_overhead_3stage": {
    "ttft_delta_ms": 7.9,
    "generation_p50_delta_ms": 3.2,
    "generation_p95_delta_ms": 3.3,
    "throughput_delta_percent": -7.1,
    "note": "3-stage adds 2 relay hops (stage0->host->stage1 + stage1->host->stage2) but per-token overhead is nearly identical to 2-stage, suggesting relay cost is dominated by the first hop setup rather than additional hops"
  }
}
